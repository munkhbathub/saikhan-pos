<!DOCTYPE html>
<html lang="mn">
<meta charset="UTF-8">
<title>Admin</title>
<body>
<h2>ADMIN</h2>

<h3>â• Menu Ğ½ÑĞ¼ÑÑ…</h3>
<input id="n" placeholder="ĞÑÑ€">
<input id="p" type="number" placeholder="Ò®Ğ½Ñ">
<select id="c">
  <option value="Ğ¥Ğ¾Ğ¾Ğ»">Ğ¥Ğ¾Ğ¾Ğ»</option>
  <option value="Ğ£Ñ">Ğ£Ñ</option>
  <option value="Ğ£Ğ½Ğ´Ğ°Ğ°">Ğ£Ğ½Ğ´Ğ°Ğ°</option>
  <option value="Ğ¦Ğ°Ğ¹">Ğ¦Ğ°Ğ¹</option>
</select>
<input id="q" type="number" placeholder="Ğ¢Ğ¾Ğ¾Ğ³Ğ¾Ğ¾ Ğ¾Ñ€ÑƒÑƒĞ»Ğ½Ğ° (ÑƒÑ/Ñ†Ğ°Ğ¹/ÑƒĞ½Ğ´Ğ°Ğ°)">
<button onclick="add()">ĞÑĞ¼ÑÑ…</button>

<h3>ğŸ“‹ Menu</h3>
<div id="list"></div>

<h3>ğŸ—‘ Ğ—Ğ°ÑĞ²Ğ°Ñ€</h3>
<div id="edit"></div>

<h3>ğŸ“Š ĞÑĞ³Ñ‚Ğ³ÑĞ»</h3>
<button onclick="loadSet()">Ğ¨Ğ¸Ğ½ÑÑ‡Ğ»ÑÑ…</button>
<div id="set"></div>

<script>
async function load(){
  const m=await fetch("/api/menu").then(r=>r.json());
  const d=await fetch("/api/drinks").then(r=>r.json());
  list.innerHTML = [...m,...d].map(x=>`${x.name} - ${x.price}â‚® (${x.cat})`).join("<br>");
  edit.innerHTML = [...m,...d].map(x=>`${x.name} <button onclick='del("${x.name}")'>âŒ</button>`).join("<br>");
}
async function add(){
  const body={name:n.value,cat:c.value,price:+p.value};
  if(c.value!=="Ğ¥Ğ¾Ğ¾Ğ»") body.qty=+q.value;
  await fetch(c.value==="Ğ¥Ğ¾Ğ¾Ğ»"?"/api/menu":"/api/drinks",{method:"POST",headers:{'Content-Type':'application/json'},body:JSON.stringify(body)});
  load();
}
async function del(name){
  await fetch("/api/menu/"+name,{method:"DELETE"});
  await fetch("/api/drinks/"+name,{method:"DELETE"});
  load();
}
async function loadSet(){
  const s=await fetch("/api/settlements").then(r=>r.json());
  set.innerHTML = s.map(set=>{
    let h=`<b>${set.date}</b><br>`;
    set.orders.forEach(o=>{ o.items.forEach(i=>h+=`${i.name} x${i.qty} = ${i.price*i.qty}â‚®<br>`) });
    return h+"<hr>";
  }).join("");
}
load();
</script>
</body>
</html>
